import{_ as on}from"./preload-helper.41c905a7.mjs";import{S as vn,i as _n,s as pn,k as E,a as P,y as un,q as j,l as k,m as R,c as N,z as an,h as w,r as U,n as V,p as W,b as J,D as g,A as ln,E as X,g as B,v as yn,d as H,f as Sn,B as cn,R as wn,J as F,o as bn,T as Mn,w as An,u as Y}from"./index.4711a160.mjs";import{M as sn}from"./snippet.e1d427ae.mjs";import{d as En,n as kn}from"./index.1d147107.mjs";import{d as Q,r as qn,w as In}from"./index.da45b3b5.mjs";const fn="=%'*";function Rn({rows:n,time:e}){if(!n)return[];let o=`-- ${En(n,{min:!0})}`;return e&&(o+=` (${e.toFixed(1)} ms)`),[o]}function dn(n,e){return n.map(({sql:o})=>o.trim()).join(e)}function Vn(n){return decodeURIComponent(n).split(fn).map(l=>({sql:l,rows:void 0,time:void 0}))}function nn(n){return encodeURIComponent(dn(n,`
`))}function tn(n){return n.flatMap(e=>[e.sql,...Rn(e)]).join(`
`)}function Dn(n){return encodeURIComponent(dn(n,fn))}var en=function(n){return function(e){return e.map(function(o){return n(o)})}},Cn=function(n){return function(e){return e.filter(n)}},Ln=function(n){return n.trim()},jn=function(n){return n.length===0},Z={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getEndomorphismMonoid=n.not=n.SK=n.hole=n.pipe=n.untupled=n.tupled=n.absurd=n.decrement=n.increment=n.tuple=n.flow=n.flip=n.constVoid=n.constUndefined=n.constNull=n.constFalse=n.constTrue=n.constant=n.unsafeCoerce=n.identity=n.apply=n.getRing=n.getSemiring=n.getMonoid=n.getSemigroup=n.getBooleanAlgebra=void 0;var e=function(t){return function(){return{meet:function(r,i){return function(u){return t.meet(r(u),i(u))}},join:function(r,i){return function(u){return t.join(r(u),i(u))}},zero:function(){return t.zero},one:function(){return t.one},implies:function(r,i){return function(u){return t.implies(r(u),i(u))}},not:function(r){return function(i){return t.not(r(i))}}}}};n.getBooleanAlgebra=e;var o=function(t){return function(){return{concat:function(r,i){return function(u){return t.concat(r(u),i(u))}}}}};n.getSemigroup=o;var l=function(t){var r=(0,n.getSemigroup)(t);return function(){return{concat:r().concat,empty:function(){return t.empty}}}};n.getMonoid=l;var c=function(t){return{add:function(r,i){return function(u){return t.add(r(u),i(u))}},zero:function(){return t.zero},mul:function(r,i){return function(u){return t.mul(r(u),i(u))}},one:function(){return t.one}}};n.getSemiring=c;var _=function(t){var r=(0,n.getSemiring)(t);return{add:r.add,mul:r.mul,one:r.one,zero:r.zero,sub:function(i,u){return function(s){return t.sub(i(s),u(s))}}}};n.getRing=_;var y=function(t){return function(r){return r(t)}};n.apply=y;function p(t){return t}n.identity=p,n.unsafeCoerce=p;function d(t){return function(){return t}}n.constant=d,n.constTrue=d(!0),n.constFalse=d(!1),n.constNull=d(null),n.constUndefined=d(void 0),n.constVoid=n.constUndefined;function h(t){return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return r.length>1?t(r[1],r[0]):function(u){return t(u)(r[0])}}}n.flip=h;function f(t,r,i,u,s,A,C,L,T){switch(arguments.length){case 1:return t;case 2:return function(){return r(t.apply(this,arguments))};case 3:return function(){return i(r(t.apply(this,arguments)))};case 4:return function(){return u(i(r(t.apply(this,arguments))))};case 5:return function(){return s(u(i(r(t.apply(this,arguments)))))};case 6:return function(){return A(s(u(i(r(t.apply(this,arguments))))))};case 7:return function(){return C(A(s(u(i(r(t.apply(this,arguments)))))))};case 8:return function(){return L(C(A(s(u(i(r(t.apply(this,arguments))))))))};case 9:return function(){return T(L(C(A(s(u(i(r(t.apply(this,arguments)))))))))}}}n.flow=f;function a(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t}n.tuple=a;function m(t){return t+1}n.increment=m;function S(t){return t-1}n.decrement=S;function q(t){throw new Error("Called `absurd` function which should be uncallable")}n.absurd=q;function M(t){return function(r){return t.apply(void 0,r)}}n.tupled=M;function b(t){return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return t(r)}}n.untupled=b;function I(t,r,i,u,s,A,C,L,T){switch(arguments.length){case 1:return t;case 2:return r(t);case 3:return i(r(t));case 4:return u(i(r(t)));case 5:return s(u(i(r(t))));case 6:return A(s(u(i(r(t)))));case 7:return C(A(s(u(i(r(t))))));case 8:return L(C(A(s(u(i(r(t)))))));case 9:return T(L(C(A(s(u(i(r(t))))))));default:{for(var O=arguments[0],K=1;K<arguments.length;K++)O=arguments[K](O);return O}}}n.pipe=I,n.hole=q;var D=function(t,r){return r};n.SK=D;function v(t){return function(r){return!t(r)}}n.not=v;var z=function(){return{concat:function(t,r){return f(t,r)},empty:p}};n.getEndomorphismMonoid=z})(Z);var mn={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.and=n.or=n.not=n.Contravariant=n.getMonoidAll=n.getSemigroupAll=n.getMonoidAny=n.getSemigroupAny=n.URI=n.contramap=void 0;var e=Z,o=function(a,m){return(0,e.pipe)(a,(0,n.contramap)(m))},l=function(a){return function(m){return(0,e.flow)(a,m)}};n.contramap=l,n.URI="Predicate";var c=function(){return{concat:function(a,m){return(0,e.pipe)(a,(0,n.or)(m))}}};n.getSemigroupAny=c;var _=function(){return{concat:(0,n.getSemigroupAny)().concat,empty:e.constFalse}};n.getMonoidAny=_;var y=function(){return{concat:function(a,m){return(0,e.pipe)(a,(0,n.and)(m))}}};n.getSemigroupAll=y;var p=function(){return{concat:(0,n.getSemigroupAll)().concat,empty:e.constTrue}};n.getMonoidAll=p,n.Contravariant={URI:n.URI,contramap:o};var d=function(a){return function(m){return!a(m)}};n.not=d;var h=function(a){return function(m){return function(S){return m(S)||a(S)}}};n.or=h;var f=function(a){return function(m){return function(S){return m(S)&&a(S)}}};n.and=f})(mn);class Un{constructor(e){}close(){}exec(e,o){return[]}}const G=qn({capi:{sqlite3_js_kvvfs_clear(){},sqlite3_js_kvvfs_size(){return 0}},oo1:{DB:Un},version:{libVersion:""}},n=>{on(()=>import("./sqlite3-bundler-friendly.ab61c93d.mjs"),[],import.meta.url).then(e=>e.default()).then(n)}),zn=Q([G],([n],e)=>{const o=new n.oo1.DB({filename:":localStorage:",flags:"ct"});return e(o),()=>o.close()}),$=In(0),On=Q([G],([n],e)=>{e(()=>{n.capi.sqlite3_js_kvvfs_clear(),$.update(o=>o+1)})}),Tn=Q([zn],([n],e)=>{e((o,l)=>{const c=n.exec(o,l);return $.update(_=>_+1),c})}),Kn=Q([G,$],([n],e)=>e(n.capi.sqlite3_js_kvvfs_size())),Pn=Q([G],([n],e)=>e(n.version.libVersion)),Nn=n=>n+";",Bn=mn.not(jn),Qn=n=>n.replaceAll(/--.*/g,""),Fn=n=>n.split(";"),Hn=n=>n.replaceAll(/(\r?\n)+/g,(e,o)=>o),Jn=Z.flow(Qn,Hn,Fn,en(Ln),Cn(Bn),en(Nn));function rn(n){let e,o,l,c,_,y,p,d,h,f,a,m,S,q,M;return m=new sn({props:{language:gn,lineNumbers:hn,model:n[6],readOnly:!0}}),{c(){e=E("div"),o=E("div"),l=E("a"),c=E("small"),_=j("Download SQL"),p=P(),d=E("a"),h=E("small"),f=j("Clear history"),a=P(),un(m.$$.fragment),this.h()},l(b){e=k(b,"DIV",{class:!0});var I=R(e);o=k(I,"DIV",{class:!0});var D=R(o);l=k(D,"A",{class:!0,download:!0,href:!0});var v=R(l);c=k(v,"SMALL",{});var z=R(c);_=U(z,"Download SQL"),z.forEach(w),v.forEach(w),p=N(D),d=k(D,"A",{href:!0});var t=R(d);h=k(t,"SMALL",{});var r=R(h);f=U(r,"Clear history"),r.forEach(w),t.forEach(w),D.forEach(w),a=N(I),an(m.$$.fragment,I),I.forEach(w),this.h()},h(){V(l,"class","margin-right-small"),V(l,"download","repl.sql"),V(l,"href",y="data:text/plain;charset=utf-8,"+nn(n[1])),V(d,"href",""),V(o,"class","text-right margin-right"),V(e,"class","padding-top-small padding-bottom-small"),W(e,"border-bottom","1px solid var(--muted-light)")},m(b,I){J(b,e,I),g(e,o),g(o,l),g(l,c),g(c,_),g(o,p),g(o,d),g(d,h),g(h,f),g(e,a),ln(m,e,null),S=!0,q||(M=X(d,"click",Mn(n[9])),q=!0)},p(b,I){(!S||I&2&&y!==(y="data:text/plain;charset=utf-8,"+nn(b[1])))&&V(l,"href",y);const D={};I&64&&(D.model=b[6]),m.$set(D)},i(b){S||(B(m.$$.fragment,b),S=!0)},o(b){H(m.$$.fragment,b),S=!1},d(b){b&&w(e),cn(m),q=!1,M()}}}function Gn(n){let e,o,l,c,_,y,p,d;return{c(){e=E("div"),o=E("small"),l=j("SQLite version: "),c=j(n[7]),_=E("br"),y=j(`
              Stored: `),p=j(n[8]),d=j("B"),this.h()},l(h){e=k(h,"DIV",{class:!0});var f=R(e);o=k(f,"SMALL",{});var a=R(o);l=U(a,"SQLite version: "),c=U(a,n[7]),_=k(a,"BR",{}),y=U(a,`
              Stored: `),p=U(a,n[8]),d=U(a,"B"),a.forEach(w),f.forEach(w),this.h()},h(){V(e,"class","text-muted")},m(h,f){J(h,e,f),g(e,o),g(o,l),g(o,c),g(o,_),g(o,y),g(o,p),g(o,d)},p(h,f){f&128&&Y(c,h[7]),f&256&&Y(p,h[8])},d(h){h&&w(e)}}}function Wn(n){let e,o,l;return{c(){e=E("div"),o=E("small"),l=j(n[4]),this.h()},l(c){e=k(c,"DIV",{class:!0});var _=R(e);o=k(_,"SMALL",{});var y=R(o);l=U(y,n[4]),y.forEach(w),_.forEach(w),this.h()},h(){V(e,"class","text-danger")},m(c,_){J(c,e,_),g(e,o),g(o,l)},p(c,_){_&16&&Y(l,c[4])},d(c){c&&w(e)}}}function Xn(n){let e,o,l,c,_,y,p,d,h,f,a,m,S,q,M,b,I,D,v=n[1].length&&rn(n),z={autofocus:n[0],error:n[4],errorOn:n[5],language:gn,lineNumbers:hn,model:n[2]};c=new sn({props:z}),n[13](c);function t(u,s){return u[4]?Wn:Gn}let r=t(n),i=r(n);return{c(){e=E("div"),v&&v.c(),o=P(),l=E("div"),un(c.$$.fragment),_=P(),y=E("div"),p=E("div"),d=E("div"),i.c(),h=P(),f=E("div"),a=E("button"),m=j("Run"),S=P(),q=E("button"),M=j("Reset"),this.h()},l(u){e=k(u,"DIV",{class:!0});var s=R(e);v&&v.l(s),o=N(s),l=k(s,"DIV",{class:!0});var A=R(l);an(c.$$.fragment,A),A.forEach(w),_=N(s),y=k(s,"DIV",{class:!0});var C=R(y);p=k(C,"DIV",{});var L=R(p);d=k(L,"DIV",{class:!0});var T=R(d);i.l(T),T.forEach(w),h=N(L),f=k(L,"DIV",{});var O=R(f);a=k(O,"BUTTON",{class:!0});var K=R(a);m=U(K,"Run"),K.forEach(w),S=N(O),q=k(O,"BUTTON",{class:!0});var x=R(q);M=U(x,"Reset"),x.forEach(w),O.forEach(w),L.forEach(w),C.forEach(w),s.forEach(w),this.h()},h(){V(l,"class","padding-top padding-bottom"),V(d,"class","margin-right-small"),W(d,"flex",1),V(a,"class","btn-small"),V(q,"class","btn-small"),W(p,"display","flex"),V(y,"class","card-footer"),V(e,"class","card margin-bottom-large")},m(u,s){J(u,e,s),v&&v.m(e,null),g(e,o),g(e,l),ln(c,l,null),g(e,_),g(e,y),g(y,p),g(p,d),i.m(d,null),g(p,h),g(p,f),g(f,a),g(a,m),g(f,S),g(f,q),g(q,M),b=!0,I||(D=[X(a,"click",n[11]),X(q,"click",n[10])],I=!0)},p(u,[s]){u[1].length?v?(v.p(u,s),s&2&&B(v,1)):(v=rn(u),v.c(),B(v,1),v.m(e,o)):v&&(yn(),H(v,1,1,()=>{v=null}),Sn());const A={};s&1&&(A.autofocus=u[0]),s&16&&(A.error=u[4]),s&32&&(A.errorOn=u[5]),s&4&&(A.model=u[2]),c.$set(A),r===(r=t(u))&&i?i.p(u,s):(i.d(1),i=r(u),i&&(i.c(),i.m(d,null)))},i(u){b||(B(v),B(c.$$.fragment,u),b=!0)},o(u){H(v),H(c.$$.fragment,u),b=!1},d(u){u&&w(e),v&&v.d(),n[13](null),cn(c),i.d(),I=!1,wn(D)}}}const gn="sql",hn="off";function Yn(n,e,o){let l,c,_,y,p;F(n,Tn,t=>o(15,c=t)),F(n,On,t=>o(16,_=t)),F(n,Pn,t=>o(7,y=t)),F(n,Kn,t=>o(8,p=t));let{autofocus:d=!1}=e,h,f,a="",m="",S,q=!1,M=[];function b(){o(1,M=[]),f.focus()}function I(t){return()=>{l=Math.max(0,Math.min(l+t,M.length));const{sql:r}=M[l]||{sql:""};h.setValue(r),o(2,h),f.focus()}}async function D(){_(),f.focus()}function v(){const t=h.getValue(),r=Jn(t);for(o(4,a="");r.length;){const i=r[0],u=kn(s=>{const A=performance.now(),C=s.catch(c,i,{rowMode:"object"},{sql:i}),L=performance.now()-A;return{sql:i,rows:C,time:L}});if(!u.ok){o(4,a=`${u.exception}`),o(5,m=u.n.sql);break}o(1,M=[...M,u.y]),r.shift()}S.setValue(tn(M)),o(6,S),h.setValue(r.join(`
`)),o(2,h),f.focus()}bn(async()=>{window.location.hash&&o(1,M=Vn(window.location.hash.substring(1)));const t=await on(()=>import("./editor.main.0a978303.mjs").then(i=>i.e),["./editor.main.0a978303.mjs","./preload-helper.41c905a7.mjs","../assets/editor.911c6360.css"],import.meta.url),r=tn(M);o(6,S=t.editor.createModel(r,"sql")),o(2,h=t.editor.createModel("","sql")),f.$set({actions:[{id:"run",keybindings:[t.KeyMod.Shift|t.KeyCode.Enter],label:"Run",run:v},{id:"next",keybindings:[t.KeyMod.Shift|t.KeyCode.DownArrow],label:"Next",run:I(1)},{id:"previous",keybindings:[t.KeyMod.Shift|t.KeyCode.UpArrow],label:"Previous",run:I(-1)}]}),o(12,q=!0)});function z(t){An[t?"unshift":"push"](()=>{f=t,o(3,f)})}return n.$$set=t=>{"autofocus"in t&&o(0,d=t.autofocus)},n.$$.update=()=>{n.$$.dirty&2&&(l=M.length),n.$$.dirty&4098&&q&&(window.location.hash=Dn(M))},[d,M,h,f,a,m,S,y,p,b,D,v,q,z]}class et extends vn{constructor(e){super(),_n(this,e,Yn,Xn,pn,{autofocus:0})}}export{et as S};
